<?php
/**
 * Magento Enterprise Edition
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magento Enterprise Edition License
 * that is bundled with this package in the file LICENSE_EE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.magentocommerce.com/license/enterprise-edition
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   Copyright (c) 2010 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://www.magentocommerce.com/license/enterprise-edition
 */
?>
<div class="dashboard">
    <div class="page-title">
        <h1><?php echo $this->__('My Dashboard') ?></h1>
    </div>
    <?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
    <?php echo $this->getChildHtml('hello') ?>
    <?php echo $this->getChildHtml('top') ?>
    <h2 class="sub-title"><?php echo $this->__('Account Information') ?></h2>
    <?php echo $this->getChildHtml('info') ?>
    <?php $_customer = $this->getCustomer(); ?>
  
    <div class="col2-set">
        <div class="info-box">
            <h3 class="box-title"><?php echo $this->__('OneID') ?></h3>
            <div class="box-content">
                <?php if (!$_customer->hasOneidUid() ): ?>
                
                     <?php
                        Mage::getSingleton('customer/session')->setBeforeAuthUrl(Mage::getUrl("customer/account"));
                     ?>
                    <div class="oneid-account-edit-block">
                    <p><?php echo $this->__('Tired of remembering your username and password? Use OneID to quickly and safely sign into this website next time. Itâ€™s free!') ?></p> 
                    <div id="oneid-link-your-oneid"></div>
                    <script type="text/javascript">
                        OneIdExtern.registerApiReadyFunction(function(){
                            OneId.loginButton(OneId.$("#oneid-link-your-oneid"), 
                                { 
                                    "oneid_user_link" : true,
                                    "user_data" : <?php echo $this->helper("OneID")->getCreateOneIdAttrs() ?>,
                                    "challenge" : <?php echo $this->helper("OneID")->getLinkCHALJ() ?> 
                                });
                        });
                    </script>
                    </div>
                <?php else: ?>
                <p>
                    This account is now protected by OneID
                </p>
                <br/>
                <a href='<?php echo Mage::getUrl("oneid/connector/removeOneid/")?>'>
                    <img src="<?php echo $this->helper("OneID")->getEndPoint()?>/images/oneid_unlink.png"/>
                </a>
                
                <?php endif; ?>
            </div>
        </div>
    </div>
    
    <div class="clear"></div>
    
    <?php echo $this->getChildHtml('address') ?>
    <?php echo $this->getChildHtml('info1') ?>
    <?php echo $this->getChildHtml('info2') ?>
</div>



